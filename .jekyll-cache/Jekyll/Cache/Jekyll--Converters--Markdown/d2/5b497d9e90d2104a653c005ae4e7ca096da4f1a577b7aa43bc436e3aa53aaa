I"√(<h1 id="configura√ß√µes-do-uc">Configura√ß√µes do uC</h1>
<p>Existem configura√ß√µes de perif√©ricos que modificam o comportamento do microcontrolador e por isso s√£o realizadas apenas no momento da grava√ß√£o, n√£o podendo ser realizadas durante a execu√ß√£o do c√≥digo, como por exemplo a habilita√ß√£o do <em>Watchdog timer</em>, a prote√ß√£o da mem√≥ria de c√≥digo, a disponibiliza√ß√£o de um determinado pino para <em>Master clear</em> ou I/O, etc.</p>

<p>A plataforma MPLAB-X proporciona uma aba para realizar tais configura√ß√£os de forma f√°cil, inclusive gerando o respectivo c√≥digo a ser inserido no programa. Este c√≥digo √© aqui gerado e inserido em um arquivo de cabe√ßalho (.h) com o nome de <strong>config</strong>, modularizando e concentrando os comandos de configura√ß√£o do microcontrolador.</p>

<h2 id="objetivo">Objetivo</h2>

<p>Criar um arquivo para a configura√ß√£o do microcontrolador utilizando a plataforma MPLAB-X.</p>

<!--more-->

<h2 id="criar-um-arquivo-fonte">Criar um arquivo fonte</h2>

<p>O passo inicial √© criar no diret√≥rio <em>Header Files</em> (Arquivos de cabe√ßalho) um arquivo com a extens√£o <strong>.h</strong>, conforme ilustrado na Figura 1.</p>

<ul>
  <li>Clique com o bot√£o direito do <em>mouse</em> sobre o diret√≥rio <strong>Header Files</strong> do projeto;</li>
  <li>Arraste o cursor at√© a op√ß√£o <strong><em>New</em></strong> e em seguida <strong><em>xc8_header.h</em></strong>.</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 1: Sele√ß√£o de novo arquivo de cabe√ßalho (.h)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig01-newH.png?raw=true" alt="Selecao novo arquivo cabe√ßalho" /></td>
    </tr>
  </tbody>
</table>

<p>A depender da vers√£o da <em>IDE</em> podem aparecer outras op√ß√µes, mas o importante √© selecionar um arquivo com a extens√£o <strong>.h</strong> e dar o nome de <strong>config</strong>, uma refer√™ncia direta ao seu conte√∫do.</p>

<ul>
  <li>No campo <strong>File Name</strong> insira o nome <strong>config</strong>.</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 2: Inser√ß√£o de nome do arquivo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig02-nome.png?raw=true" alt="Nome do arquivo .h" /></td>
    </tr>
  </tbody>
</table>

<p>Obs.: N√£o √© necess√°rio inserir a extens√£o no nome do arquivo, pois h√° um campo espec√≠fico para isso logo abaixo do local de inser√ß√£o dele.</p>

<p>Ent√£o √© gerado automaticamente um arquivo <strong>config.h</strong> com os termos de uso do software definidos pela <strong>Microchip</strong>.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 3: Arquivo de cabe√ßalho com termos de uso</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig03-termos.png?raw=true" alt="Termos de uso" /></td>
    </tr>
  </tbody>
</table>

<p>Em uma tradu√ß√£o direta no Google Tradutor temos:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Microchip Technology Inc. e suas subsidi√°rias. Voc√™ pode usar este software 
e quaisquer derivados exclusivamente com produtos Microchip.

ESTE SOFTWARE √â FORNECIDO PELA MICROCHIP "NO ESTADO EM QUE SE ENCONTRA". 
NENHUMA GARANTIA, EXPRESSA OU IMPL√çCITA, SE APLICAR A ESTE SOFTWARE, 
INCLUINDO QUAISQUER GARANTIAS IMPL√çCITAS DE N√ÉO-VIOLA√á√ÉO, comercializa√ß√£o e
adequa√ß√£o a uma finalidade espec√≠fica, ou a sua intera√ß√£o com os produtos 
microchip combina√ß√£o com quaisquer outros produtos, ou de qualquer INSCRI√á√ÉO.

EM NENHUMA HIP√ìTESE A MICROCHIP SER√Å RESPONS√ÅVEL POR QUALQUER PERDA INDIRETA,
ESPECIAL, PUNITIVA, INCIDENTAL OU CONSEQUENCIAL, DANO, CUSTO OU DESPESA DE 
QUALQUER TIPO RELACIONADO AO SOFTWARE, POR QUEM FOR CAUSADA, MESMO SE A 
MICROCHIP TIVER SIDO AVISADA PREVIAMENTE. NA EXTENS√ÉO M√ÅXIMA PERMITIDA POR LEI, 
A RESPONSABILIDADE TOTAL DA MICROCHIP EM TODAS AS REIVINDICA√á√ïES DE QUALQUER 
FORMA RELACIONADAS A ESTE SOFTWARE N√ÉO EXCEDER√Å O VALOR DAS TAXAS, SE HOUVER, 
QUE VOC√ä PAGOU DIRETAMENTE √Ä MICROCHIP POR ESTE SOFTWARE.

A MICROCHIP FORNECE ESTE SOFTWARE CONDICIONALMENTE AP√ìS SUA ACEITA√á√ÉO DESTES TERMOS.

</code></pre></div></div>

<p>Todo este texto pode ser exclu√≠do do arquivo.</p>

<ul>
  <li>Clique em qualquer lugar no texto;</li>
  <li>Pressione <strong>Ctrl+A</strong> para selecionar todo o texto;</li>
  <li>Pressione <strong>Delete</strong> para excluir o texto.</li>
  <li>Insira o seguinte c√≥digo:</li>
</ul>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#ifndef CONFIG_H
#define CONFIG_H
</span>
<span class="cp">#endif 
</span></code></pre></div></div>

<p>O resultado √© apresentado na ilustra√ß√£o da Figura 4.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 4: Arquivo config.h</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig04-config.png?raw=true" alt="Arquivo Config" /></td>
    </tr>
  </tbody>
</table>

<p>Para acessar os bits de configura√ß√£o:</p>
<ul>
  <li>Clique em <strong><em>Production</em></strong>;</li>
  <li>Selecione <strong><em>Set Configuration Bits</em></strong>;</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 5: Acessar os bits de configura√ß√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig05-setConfigBits.png?raw=true" alt="Set Config Bits" /></td>
    </tr>
  </tbody>
</table>

<p>Uma aba √© aberta, geralmente, na parte inferior da tela.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 6: Registradores de configura√ß√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig06-genCode.png?raw=true" alt="Generate Code" /></td>
    </tr>
  </tbody>
</table>

<p>Fa√ßa os ajustes em <strong><em>Options</em></strong> conforme a indica√ß√£o do quadro 1 na Figura 6.</p>

<p>Em seguida clique no bot√£o <strong><em>Generate Source Code to ‚Ä¶</em></strong>.
Uma nova aba com o c√≥digo gerado √© exibida.</p>

<p>Repare que na indica√ß√£o 3 da Figura 7 h√° um **#include <xc.h>** logo abaixo das configura√ß√µes.</xc.h></p>

<p>O quadro 7 indica o trecho que deve ser <strong>Selecionado</strong> e <strong>copiado</strong> para o <strong>config.h</strong>.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 7: C√≥digo de configura√ß√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig07-codeConfig.png?raw=true" alt="codeConfig" /></td>
    </tr>
  </tbody>
</table>

<p>O resultado ap√≥s a c√≥pia √© ilustrado na Figura 8.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 8: Configura√ß√£o no config.h</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig08-config.png?raw=true" alt="config" /></td>
    </tr>
  </tbody>
</table>

<p>Por fim, para uma necessidade futura na utiliza√ß√£o da fun√ß√£o <strong>__delay_ms(500)</strong>, insira o define:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#define _XTAL_FREQ 4000000
</span></code></pre></div></div>
<p>conforme ilustra√ß√£o da Figura 9.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 9: Defini√ß√£o da frequ√™ncia do oscilador</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig09-xtal.png?raw=true" alt="_XTAL_FREQ" /></td>
    </tr>
  </tbody>
</table>

<p>Por fim, inclua o arquivo de configura√ß√£o no arquivo principal conforme indica√ß√£o 6 da Figura 10.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 10: Inclus√£o do config no main</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig10-main.png?raw=true" alt="Include config" /></td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Pressione <strong>Shift+F11</strong> ou clique no bot√£o com a indica√ß√£o 7 da Figura 11, para realizar a limpeza e a compila√ß√£o do projeto;</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: center">Figura 11: Compila√ß√£o</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center"><img src="https://github.com/JoseWRPereira/ddp/blob/master//_posts/tUcPIC/imgP0022/fig11-compilacao.png?raw=true" alt="Compila√ß√£o" /></td>
    </tr>
  </tbody>
</table>

<p>Ap√≥s o processo de compila√ß√£o, geralmente na parte inferior, aparece uma a sa√≠da da compila√ß√£o e uma mensagem de sucesso,  <strong><em>BUILD SUCCESSFULL</em></strong>, se tudo foi feito corretamente.</p>

<p>Se alguma mensagem de erro ocorrer, veja qual √© a primeira indica√ß√£o de erro, <strong>procure entender a mensagem</strong>, clique no link de erro pois a <em>IDE</em> deve apontar o local. <strong>Atente-se para os detalhes!</strong></p>

<hr />

<blockquote>
  <blockquote>
    <blockquote>
      <p><a href="/ddp/2020/P0021-novoArquivo">¬´¬†P0021 - Novo arquivo (main.c)</a></p>
    </blockquote>
  </blockquote>
</blockquote>

<hr />

<p>Agora √© a sua vez!</p>

<p>Crie o seu projeto, copie o c√≥digo, execute-o, procure os erros, arrume-os, seja resiliente, leia novamente a explica√ß√£o, busque outras fontes, pergunte, responda, explique, fa√ßa altera√ß√µes conscientes no c√≥digo, explore, divirta-se.</p>

<p>Ficou com alguma d√∫vida, entre em contato.</p>

<p>Bom trabalho!</p>

<p><a href="/ddp/docs/tecnology/ucPIC">Voltar</a></p>
:ET